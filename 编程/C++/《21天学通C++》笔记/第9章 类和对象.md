## 第9章 类和对象

### 9.1 类和对象

#### 类的定义

要在程序中模拟人，需要一个结构，将定义人的属性（数据）以及人可使用这些属性执行的操作（函数）整合在一起。这个结构就是类。



#### 如何申明类

关键字class

``` c++
class Human{
    //定义属性
    //定义函数
}；
```

> 注意花括号后面的分号不能省略。
>
> C语言中，复合语句的 `}` 后面才不写 `;` ，因为两者都可以表示一条语句的结束，都写就重复了。
>
> 函数定义的末尾没有分号同理：并不存在特殊的语法规则，而是语法要求函数体必须是个符合语句。
>
> 而结构体大括号后面还可以申明变量，所以大括号不表示一条语句的结束。
>
> C++的类，就是基于结构体一步一步演变过来的，所以保留了这种写法。
>
> [C++的类后面的分号是否为语法规则设计上的败笔？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/441151329/answer/1710006680)



#### 如何使用类

类相当于蓝图，要使用类的功能，通常需要创建其实例--对象，并通过对象访问成员方法和属性。

创建Human对象和创建其他类型的实例类似：

``` C++
Human firstMan;
```

也可以使用new为Human对象动态地分配内存：

``` C++
Human* firstMan = new Human();
delete firstMan;
```



#### 如何访问类的成员

使用局点运算符`.`。

``` C++
Human firstMan;
firstMan.dateofBirth = "1970";
```



### 9.2 关键字public和private

信息至少可以分为两类：公有public 和 私有private。

公有意味着有了对象后就可以获取它们，私有意味着只能在类的内部（或者友元）中访问。直接通过`.`访问私有属性将报错。

设置为private的优点：

可以编写`GetAge()`让显示的年龄比实际的小；可以编写`SetAge()`验证外部输入，避免age被设置为零或者负数。



 ### 9.3 构造函数

> [通俗易懂解释一下C++的构造函数是怎样的呢？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/396004298)

构造函数是一种特殊的函数，它与类同名，且不返回任何值，在根据类创建对象时被调用。构造函数也可以重载。

``` C++
class Human
{
public:
    Human();   
};
```

构造函数的实现可以在类内也可以在类外。

``` c++
class Human
{
public:
    Human()
    {
        //函数内容
    }
};
```

``` c++
class Human
{
public:
    Human();
};
Human::Human()
{
    //函数内容
}
```

> `::`被称为==作用域解析运算符==。例如，`Human::dateOfBirth `指的是在`Human` 类中声明的变量`dateOfBirth`，而`::dateOfBirth `表示全局作用域中的变量`DateOfBirth`。



#### 何时以及如何使用构造函数

构造函数总是在创建对象时被调用，构造函数可以用来初始化成员变量。

``` c++
class Human
{
private:
    int age;
public:
    Human()
    {
        age = 1;
    }
};
```

可在不提供参数的情况下调用的构造函数被称为**默认构造函数**。

默认构造函数是可选的。如果没有写，编译器将自动创建一个。

> 这种构造函数会创建成员属性，但不会将POD类型（如int）的属性初始化为非零值。POD类型是什么？



#### 重载构造函数

构造函数可以重载。

``` c++
class Human
{
public:
    Human()
    {
        age = 1;
    }
    
    Human(int humansAge)
    {
        age = humansAge;
    }
};

int main()
{
    Human firstMan;
    Human firstWoman(20);
}
```

> 默认构造函数其实就类似于python中不写`__init__()`，而重载构造函数相当于常规的init写法。只不过C++中变量需要声明，python中不需要，所以C++中多出来这些复杂的东西。



构造函数也可以带默认值，带默认值的构造函数也是默认构造函数。也能不提供参数直接实例化。

``` c++
class Human
{
public:
    Human(int humansAge=25)
    {
        age = humansAge;
    }
};
int main()
{
    Human firstMan;
}
```



#### 包含初始化列表的构造函数

没看明白



### 9.4 析构函数

析构函数在对象被销毁时自动被调用，函数名和类名同名，但前面有一个`~`。

``` C++
class Human
{
    public:
    	~Human();
}
```

和构造函数一样，函数内容可以在类内定义内容，也可以在类外定义内容。



#### 析构函数有什么用

每当对象不再在作用域内或通过`delete`被删除进而被销毁时，都将调用析构函数。

这使得析构函数成为重置变量以及释放动态分配的内存和其他资源的理想场所。

> 当需要自己管理内存分配和释放时，构造函数new了，对应的在析构函数中要delete，释放内存。建议使用std::string，避免考虑内存问题。



### 9.5 复制构造函数

